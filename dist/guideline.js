/*!
 * guideline.js v1.0.0
 * 
 * Author: johvin
 * Date: 2018-04-25T09:17:08.958Z
 */
module.exports=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e,t){this.hintFontSize=24,this.hintTextMaxWidth=400,this.guideOptions=i(e)?e.filter(function(e){return"object"===(void 0===e?"undefined":s(e))&&"string"==typeof e.content&&e.content.trim().length>0}):[],this.callback=t,this.guideElement=null,this.cssInjected=!1,this.htmlInjected=!1,this.isGuiding=!1,this.guideIndex=-1,this.resizeWindowHandler=this.adjustGuideHintRootElementPosition.bind(this),this.clickHandler=this.clickHandler.bind(this),this.keyUpHandler=this.keyboardHandler.bind(this)}function o(e,t){new n(e,t).play()}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=!1;try{var l=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("test",null,l)}catch(e){}n.prototype={constructor:n,play:function(){this.guideOptions.length>0&&!this.isGuiding&&(this.isGuiding=!0,this.guideIndex=-1,this.injectCss(),this.injectHTML(),this.next())},prev:function(){if(this.isGuiding){var e=this.guideIndex-1;e>=0&&this.show(e)}},next:function(){this.hasNext()?this.show(this.guideIndex+1):this.isGuiding&&this.stop()},hasNext:function(){if(!this.isGuiding)return!1;var e=this.guideOptions.length,t=this.guideIndex+1;return t>=0&&t<e},show:function(e){var t=this.currentHintOption=this.guideOptions[e];this.guideElement&&this.guideElement.classList.remove("guideline-current-element"),this.guideElement=t.element,this.guideElement&&this.guideElement.classList.add("guideline-current-element"),this.guideRelativePosition=t.position,"bottom"!==this.guideRelativePosition&&"top"!==this.guideRelativePosition&&(this.guideRelativePosition="bottom"),this.guideHintRootElement||(this.guideHintRootElement=this.guideRootElement.querySelector(".guideline-guide")),this.adjustGuideHintRootElementPosition();var i=this.guideHintRootElement.firstElementChild;i&&(i.textContent=t.content,i.style.cssText="style"in t?t.style:""),this.guideIndex=e},adjustGuideHintRootElementPosition:function(){if(this.guideElement){var e="bottom"===this.guideRelativePosition;this.guideElement.scrollIntoViewIfNeeded?this.guideElement.scrollIntoViewIfNeeded():this.guideElement.scrollIntoView(e);var t=this.guideElement.getBoundingClientRect(),i=t.left,n=t.right,o=t.top,s=t.bottom,d=window.innerWidth,l=this.calcHintTextWidth(this.hintFontSize,this.currentHintOption.content)+20;l=Math.ceil(l),l>this.hintTextMaxWidth&&(l=this.hintTextMaxWidth);var r=i+n>>1,u=r;u+l/2>d&&(u=Math.floor(d-l/2)),u-l/2<0&&(u=Math.ceil(l/2));var h=Math.floor(u-l/2),a={};a.x1=l>>1,a.x2=r-h,e?(a.y1=50,a.y2=0):(a.y1=0,a.y2=50);var c=e?"top: "+(s+10)+"px":"bottom: "+(window.innerHeight-o+10)+"px",g="padding-"+(e?"top":"bottom")+": 70px";this.guideHintRootElement.style.cssText=g+"; left: "+h+"px; width: "+l+"px; "+c+";";var p=this.guideHintRootElement.querySelector("svg"),m=p.querySelector("line");p.setAttribute("width",l),p.setAttribute("height",70),e?(p.style.top=0,p.style.bottom="auto"):(p.style.top="auto",p.style.bottom=0),Object.keys(a).forEach(function(e){m.setAttribute(e,a[e])})}else{this.guideHintRootElement.style.cssText="left: 50%; top: 50%; transform: translate(-50%, -50%);";var y=this.guideHintRootElement.querySelector("svg");y.setAttribute("width",0),y.setAttribute("height",0)}},calcHintTextWidth:function(e,t){var i=document.createElement("span");i.style.position="absolute",i.style.left="-10000px",i.style.bottom=0,i.style.display="inline-block",i.style.visibility="hidden",i.style.fontSize=e+"px",i.innerText=t,document.body.appendChild(i);var n=i.getBoundingClientRect();return document.body.removeChild(i),n.width},injectCss:function(){if(!this.cssInjected){var e="guideline-css-style",t=document.getElementById(e);if(!t){t=document.createElement("style"),t.setAttribute("type","text/css"),t.id=e;var i="\n        .guideline-current-element {\n          position: relative;\n          z-index: 9991;\n          box-shadow: 0 0 4px 4px rgba(255, 0, 0, 0.8);\n          animation: breathe 2s ease 1s infinite;\n        }\n\n        .body-with-guideline {\n          overflow: hidden;\n          height: 100%;\n        }\n\n        .guideline-wrapper,\n        .guideline-bg,\n        .guideline-mask {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n\n        .guideline-wrapper {\n          transition: opacity 0.5s ease;\n          opacity: 0;\n        }\n\n        .guideline-wrapper.show {\n          opacity: 1;\n        }\n\n        .guideline-bg {\n          background: hsla(0, 0%, 0%, 0.6);\n          z-index: 9990;\n        }\n\n        .guideline-mask {\n          z-index: 9992;\n        }\n\n        .guideline-guide {\n          position: absolute;\n          color: hsl(0, 0%, 100%);\n          font-size: "+this.hintFontSize+"px;\n          z-index: 9993;\n        }\n\n        .guideline-guide > .guideline-hint {\n          display: inline-block;\n          padding: 10px;\n          line-height: 1.25;\n          text-shadow: 0 0 20px currentColor;\n        }\n\n        @keyframes breathe {\n          from {\n            box-shadow: 0 0 4px 4px rgba(255, 0, 0, 0.8);\n          }\n          50% {\n            box-shadow: 0 0 2px 1px rgba(255, 0, 0, 0.6);\n          }\n          to {\n            box-shadow: 0 0 4px 4px rgba(255, 0, 0, 0.8);\n          }\n        }\n      ";t.textContent=i,document.head.appendChild(t)}this.cssInjected=!0}},unloadCss:function(){if(this.cssInjected){var e=document.getElementById("guideline-css-style");e.parentNode.removeChild(e)}},injectHTML:function(){if(!this.htmlInjected){if(document.querySelector(".guideline-wrapper"))throw new Error("A guideline already exists, it's not allowed to run another guideline until the previous one finishes");this.htmlInjected=!0;document.body.insertAdjacentHTML("beforeend",'\n      <div class="guideline-wrapper show">\n        <div class="guideline-bg"></div>\n        <div class="guideline-mask"></div>\n        <div class="guideline-guide">\n          <span class="guideline-hint"></span>\n          <svg width="0" height="0" style="padding: 10px 0; position: absolute; left: 0; box-sizing: border-box;">\n            <defs>\n              <marker id="arrow" viewBox="0 0 12 12" refX="10" refY="6" markerWidth="6" markerHeight="20" orient="auto" style="fill: currentColor;">\n                <path d="M 0 0 L 12 6 L 0 12 z" />\n              </marker>\n            </defs>\n            <line x1="0" y1="0" x2="100" y2="100" style="stroke:currentColor;stroke-width:2" marker-end="url(#arrow)"/>\n          </svg>\n        </div>\n      </div>\n    '),document.body.classList.add("body-with-guideline"),this.guideRootElement=document.querySelector(".guideline-wrapper"),this.guideRootElement.addEventListener("click",this.clickHandler,!!d&&{passive:!0}),window.addEventListener("keyup",this.keyUpHandler,!0),window.addEventListener("resize",this.resizeWindowHandler,!!d&&{passive:!0})}},unloadHTML:function(){this.htmlInjected&&(this.htmlInjected=!1,document.body.classList.remove("body-with-guideline"),this.guideRootElement&&(this.guideRootElement.parentNode.removeChild(this.guideRootElement),this.guideRootElement=null),window.removeEventListener("keyup",this.keyUpHandler),window.removeEventListener("resize",this.resizeWindowHandler))},clickHandler:function(e){e.stopPropagation(),this.next()},keyboardHandler:function(e){if(!(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey))switch(e.keyCode||e.which){case 39:case 13:case 32:this.next();break;case 37:case 8:this.prev();break;case 27:this.stop()}},stop:function(){if(this.isGuiding){this.isGuiding=!1;var e=this.guideOptions.length,t=this.guideIndex+1;this.guideIndex=-1,this.destroy(),this.callback&&"function"==typeof this.callback&&this.callback(e,t)}},destroy:function(){this.guideOptions=null,this.guideElement&&(this.guideElement.classList.remove("guideline-current-element"),this.guideElement=null),this.unloadHTML(),this.unloadCss()}},o.Guideline=n,e.exports=o}]);